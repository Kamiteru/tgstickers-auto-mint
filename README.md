# Sticker Hunter Bot

Автоматизированная система покупки стикеров на платформе Stickerdom с поддержкой TON и Telegram Stars.

## Возможности

- **Автоматический мониторинг** - отслеживание появления коллекций и персонажей
- **Параллельные платежи** - одновременные покупки через TON и Telegram Stars
- **Telethon интеграция** - прямая оплата Stars через Telegram API без браузера
- **Решение CAPTCHA** - автоматическое преодоление защиты через Anti-captcha.com
- **Кэширование данных** - оптимизация производительности для быстрых покупок
- **Двойные уведомления** - отдельный Telegram бот для уведомлений о покупках (TON/Stars/смешанные)
- **Множественные режимы** - тестирование, симуляция, одноразовые и непрерывные покупки

## Архитектура платежей

### **TON платежи**
- **TONWalletManager** - управление TON кошельком (WalletV5R1)
- **Процесс**: API запрос → проверка баланса → отправка TON транзакции
- **Endpoint**: `/api/v1/shop/buy/crypto`

### **Telegram Stars платежи**  
- **TelegramStarsPayment** - оплата через Telethon API
- **Процесс**: API запрос → получение инвойса → оплата через SendStarsFormRequest
- **Endpoint**: `/api/v1/shop/buy`
- **Преимущества**: мгновенная оплата, без блокчейн задержек, параллельная работа с TON

### **Общие компоненты**
- **StickerdomAPI** - взаимодействие с API, CAPTCHA решение, кэширование цен (30 сек)
- **PurchaseOrchestrator** - координация покупок, параллельное выполнение платежей
- **StateCache** - кэширование баланса (5 сек) и цен для оптимизации
- **CaptchaManager** - решение капч через anticaptchaofficial
- **CollectionWatcher** - асинхронный мониторинг коллекций
- **TelegramNotifier** - уведомления через отдельного Telegram бота (поддержка TON/Stars/смешанных платежей)

## Быстрый старт

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Настройте окружение согласно `SETUP.md`

3. Протестируйте конфигурацию:
```bash
python main.py 2/19 --test
```

4. Запустите мониторинг:
```bash
python main.py 2/19
```

## Команды

- `python main.py 2/19` - мониторинг коллекции
- `python main.py 2/19 --once` - одноразовая покупка всем доступным балансом
- `python main.py 2/19 --continuous` - непрерывные покупки пока есть баланс
- `python main.py 2/19 --test` - тестирование конфигурации без покупок
- `python main.py 2/19 --dry-run` - симуляция покупок без транзакций
- `python main.py 2/19 --test-notifications` - тест 9 типов уведомлений для всех методов оплаты

Формат: `character_id/collection_id` (например, `2/19`)

## Требования

- Python 3.8+
- **Telethon 1.34.0+** (для прямой интеграции с Telegram API и Stars платежей)
- **Anticaptcha Official 1.0.46+** (для автоматического решения капч)
- **Telegram API credentials** (для Stars платежей через Telethon)
- **TON wallet seed phrase** (для TON платежей)
- **Stickerdom JWT token** (обязательно)
- **Anti-captcha.com API key** (опционально, для автоматического решения капч)
- **Telegram bot token** (опционально, для уведомлений)

## Документация

Полное руководство по настройке доступно в `SETUP.md`.

## Безопасность

Все конфиденциальные данные хранятся в переменных окружения. Не коммитьте приватные ключи или токены в репозиторий.

## Поддержка

**Телеграм канал:** [Kaiden](https://t.me/kam1teru)

## Отдельная благодарность 

**Автору данного телеграм канала за идею:** [enbanends_home](https://t.me/enbanends_home)
